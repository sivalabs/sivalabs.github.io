<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    
    
    <div class="analytics">
        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-71296890-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </div>
    
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" property="title" content="SivaLabs - How SpringBoot AutoConfiguration magic works?">
    <meta name="description" property="description" content="Java, Spring, SpringBoot, SpringCloud, JPA, Hibernate, DevOps, MicroServices, Docker tutorials - " >
    <title>SivaLabs - How SpringBoot AutoConfiguration magic works? </title>
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How SpringBoot AutoConfiguration magic works?"/>
<meta name="twitter:description" content="In my previous post Why SpringBoot? we have looked at how to create a SpringBoot application. But you may or may not understand what is going on behind the scenes. You may want to understand the magic behind the SpringBoot’s AutoConfiguration.
But before that you should know about Spring’s @Conditional feature based on which all the SpringBoot’s AutoConfiguration magic depends.
Exploring the power of @Conditional While developing Spring based applications we may come across of a need to register beans conditionally."/>
<meta name="twitter:site" content="@sivalabs"/>

    <meta name="twitter:creator" content="@sivalabs"/>
    <meta property="og:title" content="How SpringBoot AutoConfiguration magic works?" />
<meta property="og:description" content="In my previous post Why SpringBoot? we have looked at how to create a SpringBoot application. But you may or may not understand what is going on behind the scenes. You may want to understand the magic behind the SpringBoot’s AutoConfiguration.
But before that you should know about Spring’s @Conditional feature based on which all the SpringBoot’s AutoConfiguration magic depends.
Exploring the power of @Conditional While developing Spring based applications we may come across of a need to register beans conditionally." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sivalabs.github.io/2016/03/how-springboot-autoconfiguration-magic/" />
<meta property="article:published_time" content="2016-03-13T07:04:56&#43;00:00"/>
<meta property="article:modified_time" content="2016-03-13T07:04:56&#43;00:00"/>

    
<meta itemprop="name" content="How SpringBoot AutoConfiguration magic works?">
<meta itemprop="description" content="In my previous post Why SpringBoot? we have looked at how to create a SpringBoot application. But you may or may not understand what is going on behind the scenes. You may want to understand the magic behind the SpringBoot’s AutoConfiguration.
But before that you should know about Spring’s @Conditional feature based on which all the SpringBoot’s AutoConfiguration magic depends.
Exploring the power of @Conditional While developing Spring based applications we may come across of a need to register beans conditionally.">


<meta itemprop="datePublished" content="2016-03-13T07:04:56&#43;00:00" />
<meta itemprop="dateModified" content="2016-03-13T07:04:56&#43;00:00" />
<meta itemprop="wordCount" content="1615">



<meta itemprop="keywords" content="SpringBoot," />


    <link rel='stylesheet' href="/assets/css/custom-fonts.css" type='text/css' media='all'/>

    <link rel='stylesheet' href="/assets/css/style.css" type='text/css' media='all'/>
    <link rel='stylesheet' href="/assets/css/genericons.css" type='text/css' media='all'/>
    <link rel='stylesheet' href="/assets/css/font-awesome.min.css" type='text/css' media='all'/>
    <link rel='stylesheet' href="/assets/css/socicon.css" type='text/css' media='all'/>
    <link rel="stylesheet" href="/assets/css/social-logos/social-logos.css" type="text/css" media="all">
    <link rel='stylesheet' href="/assets/css/jetpack.css" type='text/css' media='all'/>
    <link rel='stylesheet' href="/assets/css/custom-styles.css" type='text/css' media='all'/>

    <script type='text/javascript' src="/assets/js/jquery-1.12.4.min.js"></script>
    <script type='text/javascript' src="/assets/js/html5shiv.min.js"></script>
    <script type='text/javascript' src="/assets/js/navigation.js"></script>

    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon" />

    

</head>
<body class="home blog logged-in admin-bar no-customize-support post-layout-one-column">
    <div id="header-top" class="header-bar-wrap"></div>
    <div id="page" class="hfeed site">
        <a class="skip-link screen-reader-text" href="#content">Skip to content</a>
        <header id="masthead" class="site-header clearfix" role="banner">
    <div class="header-main container clearfix">
        <div id="logo" class="site-branding clearfix">
            <h1 class="site-title">
                <a href="/" title="SivaLabs" rel="home">SivaLabs</a>
            </h1>
            <p class="site-description">My Experiments on Technology</p>
        </div>
        <div class="header-widgets clearfix">
        </div>
    </div>
    <div id="main-navigation-wrap" class="primary-navigation-wrap">
        <nav id="main-navigation" class="primary-navigation navigation container clearfix" role="navigation">
            <ul id="menu-home" class="main-navigation-menu">
                <li id="menu-item-1145" class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home menu-item-1145">
                    <a href="/">Home</a>
                </li>
                <li id="menu-item-1421" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1421">
                    <a href="/categories/java">Java</a>
                </li>
                <li id="menu-item-1423" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1423">
                    <a href="/categories/spring">Spring</a>
                    <ul class="sub-menu">
                        <li id="menu-item-1424" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1424">
                            <a href="/categories/springboot">Spring Boot</a>
                        </li>
                        <li id="menu-item-1425" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1425">
                            <a href="/categories/springcloud">Spring Cloud</a>
                        </li>
                    </ul>
                </li>
                <li id="menu-item-1422" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1422">
                    <a href="/categories/microservices">MicroServices</a>
                </li>
                <li id="menu-item-1151" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1151">
                    <a href="/videos">Videos</a>
                </li>
                <li id="menu-item-1161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1161">
                    <a href="/mybooks">My Books</a>
                </li>
                <li id="menu-item-1146" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1146">
                    <a href="/contact">Contact</a>
                </li>
            </ul>
        </nav>
    </div>
</header>
        <div id="content" class="site-content container clearfix">
            <section id="primary" class="content-archive content-area">
                
<main id="main" class="site-main" role="main">
<article class="post type-post status-publish format-standard hentry">
    <div class="post-inner-content">
        <header class="entry-header">
    <div class="entry-meta">
        <span class="meta-date">
            <a href="https://sivalabs.github.io/2016/03/how-springboot-autoconfiguration-magic/" rel="bookmark">
                <time class="entry-date published" datetime="2016-03-13T07:04:56">
                March 13, 2016
                </time>
            </a>
        </span>
        <span class="meta-author">
            <span class="author vcard">Siva</span>
        </span>
    </div>
    <h2 class="entry-title">
        <a href="https://sivalabs.github.io/2016/03/how-springboot-autoconfiguration-magic/" rel="bookmark">
            How SpringBoot AutoConfiguration magic works?
        </a>
    </h2>
    <div>
        
        
        
        <span class="tagcloud post-tags">
            <i class="fa fa-tags"></i>
            
            <a class="tag-cloud-link widget__link widget__link--taglist" href="/tags/springboot/">SpringBoot</a>
            
            
        </span>
        
        
    </div>
</header>

        <div class="entry-content">
            

<p>In my previous post <a href="/2016/03/why-springboot/">Why SpringBoot?</a> we have looked at how to create a SpringBoot application. But you may or may not understand what is going on behind the scenes. You may want to understand the magic behind the SpringBoot’s AutoConfiguration.</p>

<p>But before that you should know about Spring’s <strong>@Conditional</strong> feature based on which all the SpringBoot’s AutoConfiguration magic depends.</p>

<h2 id="exploring-the-power-of-conditional">Exploring the power of @Conditional</h2>

<p>While developing Spring based applications we may come across of a need to register beans conditionally.</p>

<p>For example, you may want to register a DataSource bean pointing to DEV Database while running application locally and point to a different PRODUCTION Database while running in production.&nbsp;</p>

<p>You can externalize the database connection parameters into properties files and use the file appropriate for the environment. But you need to change the configuration whenever you need to point to a different environment and build the application.</p>

<p>To address this problem Spring 3.1 introduced the concept of <strong>Profiles</strong>. You can register multiple beans of the same type and associate them to one or more profiles. When you run the application you can activate the desired profiles and beans associated with the activated profiles only will be registered.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AppConfig</span>
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Bean</span>
    <span style="color:#a6e22e">@Profile</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;DEV&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">public</span> DataSource <span style="color:#a6e22e">devDataSource</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#f92672">...</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Bean</span>
    <span style="color:#a6e22e">@Profile</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;PROD&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">public</span> DataSource <span style="color:#a6e22e">prodDataSource</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#f92672">...</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>Then you can specify the active profile using System Property <strong>-Dspring.profiles.active=DEV</strong></p>

<p>This approach works for simple cases like enable or disable bean registrations based on activated profiles. But if you want to register beans based on some conditional logic then the Profiles approach itself is not sufficient.</p>

<p>To provide much more flexibility for registering Spring beans conditionally, Spring 4 introduced the concept of <strong>@Conditional</strong>. By using <strong>@Conditional</strong> approach you can register a bean conditionally based on any arbitrary condition.</p>

<p>For example, you may want to register a bean when:</p>

<ul>
<li>A specific class is present in classpath&nbsp;</li>
<li>A Spring bean of certain type doesn’t already registered in ApplicationContext&nbsp;</li>
<li>A specific file exists on a location&nbsp;</li>
<li>A specific property value is configured in a configuration file&nbsp;</li>
<li>A specific system property is present/absent&nbsp;</li>
</ul>

<p>These are just a few examples only and you can have any condition you want.</p>

<p>Let us take a look at how Spring’s @Conditional works.</p>

<p>Suppose we have a <strong>UserDAO</strong> interface with methods to get data from a data store. We have two implements of <strong>UserDAO</strong> interface namely <strong>JdbcUserDAO</strong> which talks to <strong>MySQL</strong> database and <strong>MongoUserDAO</strong> which talks to <strong>MongoDB</strong>.</p>

<p>We may want to enable only one of <strong>JdbcUserDAO</strong> and <strong>MongoUserDAO</strong> based on a System Property say <strong>dbType</strong>.</p>

<p>If the application is started using <strong>java -jar myapp.jar -DdbType=MySQL</strong> then we want to enable <strong>JdbcUserDAO</strong>, otherwise if the application is started using <strong>java -jar myapp.jar -DdbType=MONGO</strong> we want to enable <strong>MongoUserDAO</strong>.</p>

<p>Suppose we have <strong>UserDAO</strong> interface and <strong>JdbcUserDAO</strong>, <strong>MongoUserDAO</strong> implementations as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserDAO</span>
<span style="color:#f92672">{</span>
    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getAllUserNames</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">JdbcUserDAO</span> <span style="color:#66d9ef">implements</span> UserDAO
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getAllUserNames</span><span style="color:#f92672">()</span>
    <span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;**** Getting usernames from RDBMS *****&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">asList</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Siva&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;Prasad&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;Reddy&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MongoUserDAO</span> <span style="color:#66d9ef">implements</span> UserDAO
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getAllUserNames</span><span style="color:#f92672">()</span>
    <span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;**** Getting usernames from MongoDB *****&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">asList</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Bond&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;James&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;Bond&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>We can implement the Condition <strong>MySQLDatabaseTypeCondition</strong> to check whether the System Property <strong>dbType</strong> is <strong>&#8220;MYSQL&#8221;</strong> as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MySQLDatabaseTypeCondition</span> <span style="color:#66d9ef">implements</span> Condition
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span><span style="color:#f92672">(</span>ConditionContext conditionContext<span style="color:#f92672">,</span> AnnotatedTypeMetadata metadata<span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        String enabledDBType <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">getProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dbType&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>enabledDBType <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> enabledDBType<span style="color:#f92672">.</span><span style="color:#a6e22e">equalsIgnoreCase</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;MYSQL&#34;</span><span style="color:#f92672">));</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>We can implement the Condition <strong>MongoDBDatabaseTypeCondition</strong> to check whether the System Property <strong>dbType</strong> is &#8220;<strong>MONGODB</strong>&#8221; as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MongoDBDatabaseTypeCondition</span> <span style="color:#66d9ef">implements</span> Condition
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span><span style="color:#f92672">(</span>ConditionContext conditionContext<span style="color:#f92672">,</span> AnnotatedTypeMetadata metadata<span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        String enabledDBType <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">getProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dbType&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>enabledDBType <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> enabledDBType<span style="color:#f92672">.</span><span style="color:#a6e22e">equalsIgnoreCase</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;MONGODB&#34;</span><span style="color:#f92672">));</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>Now we can configure both <strong>JdbcUserDAO</strong> and <strong>MongoUserDAO</strong> beans conditionally using <strong>@Conditional</strong> as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AppConfig</span>
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Bean</span>
    <span style="color:#a6e22e">@Conditional</span><span style="color:#f92672">(</span>MySQLDatabaseTypeCondition<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">public</span> UserDAO <span style="color:#a6e22e">jdbcUserDAO</span><span style="color:#f92672">(){</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> JdbcUserDAO<span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Bean</span>
    <span style="color:#a6e22e">@Conditional</span><span style="color:#f92672">(</span>MongoDBDatabaseTypeCondition<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">public</span> UserDAO <span style="color:#a6e22e">mongoUserDAO</span><span style="color:#f92672">(){</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> MongoUserDAO<span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>If we run the application like <strong>java -jar myapp.jar -DdbType=MYSQL</strong> then only <strong>JdbcUserDAO</strong> bean will be registered.</p>

<p>But if you set the System property like <strong>-DdbType=MONGODB</strong> then only <strong>MongoUserDAO</strong> bean will be registered.</p>

<p>Now that we have seen how to conditionally register a bean based on System Property.</p>

<p>Suppose we want to register <strong>MongoUserDAO</strong> bean only when <strong>MongoDB</strong> java driver class <strong>&#8220;com.mongodb.Server&#8221;</strong> is available on classpath, if not we want to register <strong>JdbcUserDAO</strong> bean.&nbsp;</p>

<p>To accomplish that we can create Conditions to check the presence or absence of MongoDB driver class <strong>&#8220;com.mongodb.Server&#8221;</strong> as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MongoDriverPresentsCondition</span> <span style="color:#66d9ef">implements</span> Condition
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span><span style="color:#f92672">(</span>ConditionContext conditionContext<span style="color:#f92672">,</span>AnnotatedTypeMetadata metadata<span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            Class<span style="color:#f92672">.</span><span style="color:#a6e22e">forName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;com.mongodb.Server&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>ClassNotFoundException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MongoDriverNotPresentsCondition</span> <span style="color:#66d9ef">implements</span> Condition
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span><span style="color:#f92672">(</span>ConditionContext conditionContext<span style="color:#f92672">,</span> AnnotatedTypeMetadata metadata<span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            Class<span style="color:#f92672">.</span><span style="color:#a6e22e">forName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;com.mongodb.Server&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>ClassNotFoundException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>We just have seen how to register beans conditionally based on presence/absence of a class in classpath.</p>

<p>What if we want to register <strong>MongoUserDAO</strong> bean only if no other Spring bean of type <strong>UserDAO</strong> is already registered.</p>

<p>We can create a Condition to check if there is any existing bean of a certain type as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserDAOBeanNotPresentsCondition</span> <span style="color:#66d9ef">implements</span> Condition
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span><span style="color:#f92672">(</span>ConditionContext conditionContext<span style="color:#f92672">,</span> AnnotatedTypeMetadata metadata<span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        UserDAO userDAO <span style="color:#f92672">=</span> conditionContext<span style="color:#f92672">.</span><span style="color:#a6e22e">getBeanFactory</span><span style="color:#f92672">().</span><span style="color:#a6e22e">getBean</span><span style="color:#f92672">(</span>UserDAO<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>userDAO <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>What if we want to register <strong>MongoUserDAO</strong> bean only if property <strong>app.dbType=MONGO</strong> is set in properties placeholder configuration file?</p>

<p>We can implement that Condition as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MongoDbTypePropertyCondition</span> <span style="color:#66d9ef">implements</span> Condition
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span><span style="color:#f92672">(</span>ConditionContext conditionContext<span style="color:#f92672">,</span>
    AnnotatedTypeMetadata metadata<span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        String dbType <span style="color:#f92672">=</span> conditionContext<span style="color:#f92672">.</span><span style="color:#a6e22e">getEnvironment</span><span style="color:#f92672">()</span>
                            <span style="color:#f92672">.</span><span style="color:#a6e22e">getProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;app.dbType&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;MONGO&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">equalsIgnoreCase</span><span style="color:#f92672">(</span>dbType<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>We have just seen how to implement various types of Conditions.</p>

<p>But there is even more elegant way to implement Conditions using Annotations. Instead of creating a Condition implementation for both MYSQL and MongoDB, we can create aDatabaseType annotation as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Target</span><span style="color:#f92672">({</span> ElementType<span style="color:#f92672">.</span><span style="color:#a6e22e">TYPE</span><span style="color:#f92672">,</span> ElementType<span style="color:#f92672">.</span><span style="color:#a6e22e">METHOD</span> <span style="color:#f92672">})</span>
<span style="color:#a6e22e">@Retention</span><span style="color:#f92672">(</span>RetentionPolicy<span style="color:#f92672">.</span><span style="color:#a6e22e">RUNTIME</span><span style="color:#f92672">)</span>
<span style="color:#a6e22e">@Conditional</span><span style="color:#f92672">(</span>DatabaseTypeCondition<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">@interface</span> DatabaseType
<span style="color:#f92672">{</span>
    String <span style="color:#a6e22e">value</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>Then we can implement <strong>DatabaseTypeCondition</strong> to use the <strong>DatabaseType</strong> value to determine whether to enable or disable bean registration as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DatabaseTypeCondition</span> <span style="color:#66d9ef">implements</span> Condition
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span><span style="color:#f92672">(</span>ConditionContext conditionContext<span style="color:#f92672">,</span>
    AnnotatedTypeMetadata metadata<span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;</span> attributes <span style="color:#f92672">=</span> metadata<span style="color:#f92672">.</span><span style="color:#a6e22e">getAnnotationAttributes</span><span style="color:#f92672">(</span>DatabaseType<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">());</span>
        String type <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>String<span style="color:#f92672">)</span> attributes<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">);</span>
        String enabledDBType <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">getProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dbType&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;MYSQL&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>enabledDBType <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> type <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> enabledDBType<span style="color:#f92672">.</span><span style="color:#a6e22e">equalsIgnoreCase</span><span style="color:#f92672">(</span>type<span style="color:#f92672">));</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>Now we can use the <strong>@DatabaseType</strong> annotation on our bean definitions as follows:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#a6e22e">@ComponentScan</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AppConfig</span>
<span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@DatabaseType</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;MYSQL&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">public</span> UserDAO <span style="color:#a6e22e">jdbcUserDAO</span><span style="color:#f92672">(){</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> JdbcUserDAO<span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Bean</span>
    <span style="color:#a6e22e">@DatabaseType</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;MONGO&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">public</span> UserDAO <span style="color:#a6e22e">mongoUserDAO</span><span style="color:#f92672">(){</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> MongoUserDAO<span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>Here we are getting the metadata from <strong>DatabaseType</strong> annotation and checking against the System Property <strong>dbType</strong> value to determine whether to enable or disable the bean registration.</p>

<p>We have seen good number of examples to understand how we can register beans conditionally using <strong>@Conditional</strong> annotation.</p>

<p>SpringBoot extensively uses <strong>@Conditional</strong> feature to register beans conditionally based on various criteria.</p>

<p>You can find various Condition implementations that SpringBoot uses in <strong>org.springframework.boot.autoconfigure</strong> package of <strong>spring-boot-autoconfigure-{version}.jar</strong>.&nbsp;</p>

<p>Now that we come to know about how SpringBoot uses <strong>@Conditional</strong> feature to conditionally check whether to register a bean or not.</p>

<p>But what exactly triggers the auto-configuration mechanism?</p>

<p>This is what we are going to look at in next section.</p>

<h3 id="springboot-autoconfiguration">SpringBoot AutoConfiguration</h3>

<p>The key to the SpringBoot’s auto-configuration magic is <strong>@EnableAutoConfiguration</strong> annotation.
Typically we annotate our Application entry point class with either <strong>@SpringBootApplication</strong> or
if we want to customize the defaults we can use the following annotations:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#a6e22e">@EnableAutoConfiguration</span>
<span style="color:#a6e22e">@ComponentScan</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Application</span>
<span style="color:#f92672">{</span>

<span style="color:#f92672">}</span></code></pre></div>

<p>The <strong>@EnableAutoConfiguration</strong> annotation enables the auto-configuration of Spring <strong>ApplicationContext</strong> by scanning the classpath components and registers the beans that are matching various Conditions.&nbsp;</p>

<p>SpringBoot provides various <strong>AutoConfiguration</strong> classes in <strong>spring-boot-autoconfigure-{version}.jar</strong> which are responsible for registering various components.</p>

<p>Typically <strong>AutoConfiguration</strong> classes are annotated with <strong>@Configuration</strong> to mark it as a Spring configuration class and annotated with <strong>@EnableConfigurationProperties</strong> to bind the customization properties and one or more Conditional bean registration methods.</p>

<p>For example consider <strong>org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration</strong> class.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#a6e22e">@ConditionalOnClass</span><span style="color:#f92672">({</span> DataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> EmbeddedDatabaseType<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">})</span>
<span style="color:#a6e22e">@EnableConfigurationProperties</span><span style="color:#f92672">(</span>DataSourceProperties<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
<span style="color:#a6e22e">@Import</span><span style="color:#f92672">({</span> Registrar<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> DataSourcePoolMetadataProvidersConfiguration<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">})</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DataSourceAutoConfiguration</span> 
<span style="color:#f92672">{</span>
    <span style="color:#f92672">...</span>
    <span style="color:#f92672">...</span>
    <span style="color:#a6e22e">@Conditional</span><span style="color:#f92672">(</span>DataSourceAutoConfiguration<span style="color:#f92672">.</span><span style="color:#a6e22e">EmbeddedDataSourceCondition</span><span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#a6e22e">@ConditionalOnMissingBean</span><span style="color:#f92672">({</span> DataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> XADataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">})</span>
    <span style="color:#a6e22e">@Import</span><span style="color:#f92672">(</span>EmbeddedDataSourceConfiguration<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EmbeddedConfiguration</span> <span style="color:#f92672">{</span>

    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Configuration</span>
    <span style="color:#a6e22e">@ConditionalOnMissingBean</span><span style="color:#f92672">(</span>DataSourceInitializer<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DataSourceInitializerConfiguration</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Bean</span>
        <span style="color:#66d9ef">public</span> DataSourceInitializer <span style="color:#a6e22e">dataSourceInitializer</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> DataSourceInitializer<span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Conditional</span><span style="color:#f92672">(</span>DataSourceAutoConfiguration<span style="color:#f92672">.</span><span style="color:#a6e22e">NonEmbeddedDataSourceCondition</span><span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#a6e22e">@ConditionalOnMissingBean</span><span style="color:#f92672">({</span> DataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> XADataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">})</span>
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NonEmbeddedConfiguration</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Autowired</span>
        <span style="color:#66d9ef">private</span> DataSourceProperties properties<span style="color:#f92672">;</span>

        <span style="color:#a6e22e">@Bean</span>
        <span style="color:#a6e22e">@ConfigurationProperties</span><span style="color:#f92672">(</span>prefix <span style="color:#f92672">=</span> DataSourceProperties<span style="color:#f92672">.</span><span style="color:#a6e22e">PREFIX</span><span style="color:#f92672">)</span>
        <span style="color:#66d9ef">public</span> DataSource <span style="color:#a6e22e">dataSource</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
            DataSourceBuilder factory <span style="color:#f92672">=</span> DataSourceBuilder
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">properties</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getClassLoader</span><span style="color:#f92672">())</span>
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">driverClassName</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">properties</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getDriverClassName</span><span style="color:#f92672">())</span>
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">url</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">properties</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getUrl</span><span style="color:#f92672">()).</span><span style="color:#a6e22e">username</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">properties</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getUsername</span><span style="color:#f92672">())</span>
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">password</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">properties</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPassword</span><span style="color:#f92672">());</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">properties</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getType</span><span style="color:#f92672">()</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                factory<span style="color:#f92672">.</span><span style="color:#a6e22e">type</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">properties</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getType</span><span style="color:#f92672">());</span>
            <span style="color:#f92672">}</span>
            <span style="color:#66d9ef">return</span> factory<span style="color:#f92672">.</span><span style="color:#a6e22e">build</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    <span style="color:#f92672">...</span>
    <span style="color:#f92672">...</span>
    <span style="color:#a6e22e">@Configuration</span>
    <span style="color:#a6e22e">@ConditionalOnProperty</span><span style="color:#f92672">(</span>prefix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spring.datasource&#34;</span><span style="color:#f92672">,</span> name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jmx-enabled&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#a6e22e">@ConditionalOnClass</span><span style="color:#f92672">(</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;org.apache.tomcat.jdbc.pool.DataSourceProxy&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#a6e22e">@Conditional</span><span style="color:#f92672">(</span>DataSourceAutoConfiguration<span style="color:#f92672">.</span><span style="color:#a6e22e">DataSourceAvailableCondition</span><span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#a6e22e">@ConditionalOnMissingBean</span><span style="color:#f92672">(</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dataSourceMBean&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TomcatDataSourceJmxConfiguration</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Bean</span>
        <span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">dataSourceMBean</span><span style="color:#f92672">(</span>DataSource dataSource<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#f92672">....</span>
        <span style="color:#f92672">....</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    <span style="color:#f92672">...</span>
    <span style="color:#f92672">...</span>
<span style="color:#f92672">}</span></code></pre></div>

<p>Here <strong>DataSourceAutoConfiguration</strong> is annotated with <strong>@ConditionalOnClass({ DataSource.class,EmbeddedDatabaseType.class })</strong>
which means that Auto Configuration of beans within <strong>DataSourceAutoConfiguration</strong> will be considered only if <strong>DataSource.class</strong>
and <strong>EmbeddedDatabaseType.class</strong> classes are available on classpath.</p>

<p>The class is also annotated with <strong>@EnableConfigurationProperties(DataSourceProperties.class)</strong> which enables binding the properties
in <strong>application.properties</strong> to the properties of <strong>DataSourceProperties</strong> class automatically.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@ConfigurationProperties</span><span style="color:#f92672">(</span>prefix <span style="color:#f92672">=</span> DataSourceProperties<span style="color:#f92672">.</span><span style="color:#a6e22e">PREFIX</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DataSourceProperties</span> <span style="color:#66d9ef">implements</span> BeanClassLoaderAware<span style="color:#f92672">,</span> EnvironmentAware<span style="color:#f92672">,</span> InitializingBean <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String PREFIX <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spring.datasource&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">...</span>
    <span style="color:#f92672">...</span>
    <span style="color:#66d9ef">private</span> String driverClassName<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> String url<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> String username<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> String password<span style="color:#f92672">;</span>
    <span style="color:#f92672">...</span>
    <span style="color:#75715e">//setters and getters
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span></code></pre></div>

<p>With this configuration all the properties that starts with <strong>spring.datasource.</strong>* will be automatically binds to <strong>DataSourceProperties</strong> object.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">spring<span style="color:#f92672">.</span><span style="color:#a6e22e">datasource</span><span style="color:#f92672">.</span><span style="color:#a6e22e">url</span><span style="color:#f92672">=</span>jdbc:mysql:<span style="color:#75715e">//localhost:3306/test
</span><span style="color:#75715e"></span>spring<span style="color:#f92672">.</span><span style="color:#a6e22e">datasource</span><span style="color:#f92672">.</span><span style="color:#a6e22e">username</span><span style="color:#f92672">=</span>root
spring<span style="color:#f92672">.</span><span style="color:#a6e22e">datasource</span><span style="color:#f92672">.</span><span style="color:#a6e22e">password</span><span style="color:#f92672">=</span>secret
spring<span style="color:#f92672">.</span><span style="color:#a6e22e">datasource</span><span style="color:#f92672">.</span><span style="color:#a6e22e">driver</span><span style="color:#f92672">-</span>class<span style="color:#f92672">-</span>name<span style="color:#f92672">=</span>com<span style="color:#f92672">.</span><span style="color:#a6e22e">mysql</span><span style="color:#f92672">.</span><span style="color:#a6e22e">jdbc</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Driver</span></code></pre></div>

<p>You can also see some inner classes and bean definition methods that are annotated with SpringBoot’s Conditional annotations
such as <strong>@ConditionalOnMissingBean, @ConditionalOnClass and @ConditionalOnProperty</strong> etc.</p>

<p>These bean definitions will be registered in <strong>ApplicationContext</strong> only if those conditions are matched.</p>

<p>You can also explore many other AutoConfiguration classes in <strong>spring-boot-autoconfigure-{version}.jar</strong> such as</p>

<ul>
<li>org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration&nbsp;</li>
<li>org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration&nbsp;</li>
<li>org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration&nbsp;</li>

<li><p>org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration</p>

<p>etc etc.&nbsp;</p></li>
</ul>

<p>I hope now you have an understanding of how SpringBoot auto-configuration works by using various AutoConfiration classes
along with <strong>@Conditional</strong> features.</p>

        </div>
        <div class="sharedaddy sd-sharing-enabled">
    <div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing">
        <h3 class="sd-title">Share this:</h3>
        <div class="sd-content">
            <ul>
                <li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-1144" class="share-twitter sd-button share-icon no-text" href="https://twitter.com/intent/tweet?status=How%20SpringBoot%20AutoConfiguration%20magic%20works%3f-https%3a%2f%2fsivalabs.github.io%2f2016%2f03%2fhow-springboot-autoconfiguration-magic%2f" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li>
                <li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-1144" class="share-facebook sd-button share-icon no-text" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fsivalabs.github.io%2f2016%2f03%2fhow-springboot-autoconfiguration-magic%2f" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li>
                <li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-1144" class="share-google-plus-1 sd-button share-icon no-text" href="https://plus.google.com/share?url=https%3a%2f%2fsivalabs.github.io%2f2016%2f03%2fhow-springboot-autoconfiguration-magic%2f" target="_blank" title="Click to share on Google+"><span></span><span class="sharing-screen-reader-text">Click to share on Google+ (Opens in new window)</span></a></li>
                <li class="share-reddit"><a rel="nofollow" data-shared="" class="share-reddit sd-button share-icon no-text" href="http://www.reddit.com/submit?url=https%3a%2f%2fsivalabs.github.io%2f2016%2f03%2fhow-springboot-autoconfiguration-magic%2f&title=How%20SpringBoot%20AutoConfiguration%20magic%20works%3f" target="_blank" title="Click to share on Reddit"><span></span><span class="sharing-screen-reader-text">Click to share on Reddit (Opens in new window)</span></a></li>
                <li class="share-linkedin"><a rel="nofollow" data-shared="sharing-linkedin-1144" class="share-linkedin sd-button share-icon no-text" href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fsivalabs.github.io%2f2016%2f03%2fhow-springboot-autoconfiguration-magic%2f&title=How%20SpringBoot%20AutoConfiguration%20magic%20works%3f" target="_blank" title="Click to share on LinkedIn"><span></span><span class="sharing-screen-reader-text">Click to share on LinkedIn (Opens in new window)</span></a></li>
                <li class="share-end"></li>
            </ul>
        </div>
    </div>
</div>

    </div>
</article>


<div class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "sivalabs" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>



<nav class="navigation post-navigation" role="navigation">
	<h2 class="screen-reader-text">Post navigation</h2>
	<div class="nav-links">
		<div class="nav-previous">
			<a href="/2016/03/springboot-working-with-jdbctemplate/" rel="next">
				<i class="fa fa-chevron-left"></i>
				<span class="post-title">SpringBoot : Working with JdbcTemplate</span>
			</a>
		</div>
		<div class="nav-next">
			<a href="/2016/03/why-springboot/" rel="prev">
                <span class="post-title">Why SpringBoot?
                    <i class="fa fa-chevron-right"></i>
                </span>
			</a>
		</div>
	</div>
</nav>

</main>

            </section>

            <section id="secondary" class="sidebar widget-area clearfix" role="complementary">
                
<aside id="zoom-social-icons-widget-2" class="widget zoom-social-icons-widget">
    <h3 class="widget-title">Follow Me</h3>

    <ul class="zoom-social-icons-list zoom-social-icons-list--with-canvas zoom-social-icons-list--rounded zoom-social-icons-list--no-labels">

        
        <li class="zoom-social_icons-list__item">
            <a class="zoom-social_icons-list__link"
               href="https://github.com/sivaprasadreddy"
               target="_blank">
                    <span class="zoom-social_icons-list-span socicon socicon-github"
                          data-hover-rule="background-color" data-hover-color="#221e1b"

                    ></span>
            </a>
        </li>
        

        
        <li class="zoom-social_icons-list__item">
            <a class="zoom-social_icons-list__link"
               href="https://twitter.com/sivalabs"
               target="_blank">
                    <span class="zoom-social_icons-list-span socicon socicon-twitter"
                          data-hover-rule="background-color" data-hover-color="#55acee"
                    ></span>
            </a>
        </li>
        

        

        

        
        <li class="zoom-social_icons-list__item">
            <a class="zoom-social_icons-list__link"
               href="https://in.linkedin.com/in/siva-prasad-reddy-k-3a909172"
               target="_blank">
                    <span class="zoom-social_icons-list-span socicon socicon-linkedin"
                          data-hover-rule="background-color" data-hover-color="#3371b7"
                    ></span>
            </a>
        </li>

        

        
        <li class="zoom-social_icons-list__item">
            <a class="zoom-social_icons-list__link"
               href="http://www.youtube.com/c/SivaPrasadReddy%20"
               target="_blank">
                    <span class="zoom-social_icons-list-span socicon socicon-youtube"
                          data-hover-rule="background-color" data-hover-color="#e02a20"
                    ></span>
            </a>
        </li>
        
    </ul>
</aside>



<aside id="recent-posts-2" class="widget widget_recent_entries clearfix">
    <div class="widget-header">
        <h3 class="widget-title">Recent Posts</h3>
    </div>
    <ul>
        <li class="widget__item"><a class="widget__link" href="/2019/06/kafka-tutorial-producer-consumer-using-spring-boot/">Kafka Tutorial - Producer and Consumer using SpringBoot</a></li>
        <li class="widget__item"><a class="widget__link" href="/2019/06/kafka-tutorial-java-producer-consumer/">Kafka Tutorial - Java Producer and Consumer</a></li>
        <li class="widget__item"><a class="widget__link" href="/2019/05/spring-boot-best-practices/">SpringBoot Best Practices</a></li>
        <li class="widget__item"><a class="widget__link" href="/2018/03/microservices-part-6-distributed-tracing-with-spring-cloud-sleuth-and-zipkin/">MicroServices - Part 6 : Distributed Tracing with Spring Cloud Sleuth and Zipkin</a></li>
        <li class="widget__item"><a class="widget__link" href="/2018/03/microservices-part-5-spring-cloud-zuul-proxy-as-api-gateway/">MicroServices - Part 5 : Spring Cloud Zuul Proxy as API Gateway</a></li>
    </ul>

</aside>

<aside id="top-posts-2" class="widget widget_top-posts clearfix">
    <div class="widget-header"><h3 class="widget-title">Top Posts &amp; Pages</h3></div>
    <ul>

        <li>
            <a href="/2016/03/why-springboot/"
            class="bump-view" data-bump-view="tp">
            Why SpringBoot?</a>
        </li>

        <li>
            <a href="/2016/03/how-springboot-autoconfiguration-magic/"
            class="bump-view" data-bump-view="tp">
            How SpringBoot AutoConfiguration magic works?</a>
        </li>

        <li>
            <a href="/2015/11/developing-a-simple-e-commerce-application-from-scratch-to-production-using-springboot/"
            class="bump-view" data-bump-view="tp">
            Developing a simple e-commerce application from scratch to production using SpringBoot</a>
        </li>

        <li>
            <a href="/2013/12/clean-code-dont-mix-different-levels-of-abstractions/"
            class="bump-view" data-bump-view="tp">
            Clean Code: Don’t mix different levels of abstractions</a>
        </li>

        <li>
            <a href="/2015/06/a-developers-perspective-on-spring-vs-javaee/"
            class="bump-view" data-bump-view="tp">
            A Developers Perspective on Spring vs JavaEE</a>
        </li>

        <li>
            <a href="/2015/07/my-life-as-software-developer-in-india/"
            class="bump-view" data-bump-view="tp">
            My Life as a Software Developer in India</a>
        </li>

        <li>
            <a href="/2011/01/10-things-to-become-outstanding-java/"
            class="bump-view" data-bump-view="tp">
            10 things to become an outstanding Java developer</a>
        </li>
</ul>
</aside>

<aside id="categories-2" class="widget widget_categories clearfix">
    <div class="widget-header"><h3 class="widget-title">Categories</h3></div>
    <ul>
        <li class="cat-item"><a href="/categories/best-practices">Best-Practices</a></li>
        <li class="cat-item"><a href="/categories/blog">Blog</a></li>
        <li class="cat-item"><a href="/categories/books">Books</a></li>
        <li class="cat-item"><a href="/categories/ide">Ide</a></li>
        <li class="cat-item"><a href="/categories/java">Java</a></li>
        <li class="cat-item"><a href="/categories/javaee">Javaee</a></li>
        <li class="cat-item"><a href="/categories/kafka">Kafka</a></li>
        <li class="cat-item"><a href="/categories/linux">Linux</a></li>
        <li class="cat-item"><a href="/categories/microservices">Microservices</a></li>
        <li class="cat-item"><a href="/categories/misc">Misc</a></li>
        <li class="cat-item"><a href="/categories/spring">Spring</a></li>
        <li class="cat-item"><a href="/categories/springboot">Springboot</a></li>
        <li class="cat-item"><a href="/categories/springcloud">Springcloud</a></li>
        <li class="cat-item"><a href="/categories/tips">Tips</a></li>
        <li class="cat-item"><a href="/categories/travis-ci">Travis-Ci</a></li>
        <li class="cat-item"><a href="/categories/videos">Videos</a></li>
    </ul>
</aside>


<aside id="tag_cloud-3" class="widget widget_tag_cloud clearfix">
    <div class="widget-header"><h3 class="widget-title">Tags</h3></div>
    <div class="tagcloud">

        <div class="widget__content">
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/android" title="android">android</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/best-practices" title="best-practices">best-practices</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/blog" title="blog">blog</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/blogging" title="blogging">blogging</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/books" title="books">books</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/e-commerce" title="e-commerce">e-commerce</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/ide" title="ide">ide</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/interviews" title="interviews">interviews</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/it" title="it">it</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/java" title="java">java</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/javaee" title="javaee">javaee</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/jcart" title="jcart">jcart</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/jooq" title="jooq">jooq</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/jsf" title="jsf">jsf</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/kafka" title="kafka">kafka</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/kafka-springboot-spring" title="kafka-springboot-spring">kafka-springboot-spring</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/linux" title="linux">linux</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/maven" title="maven">maven</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/microservices" title="microservices">microservices</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/mybatis" title="mybatis">mybatis</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/primefaces" title="primefaces">primefaces</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/rabbitmq" title="rabbitmq">rabbitmq</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/servlets-jsp" title="servlets-jsp">servlets-jsp</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/spring" title="spring">spring</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/spring-springboot-bestpractices" title="spring-springboot-bestpractices">spring-springboot-bestpractices</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/springboot" title="springboot">springboot</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/springcloud" title="springcloud">springcloud</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/springsession" title="springsession">springsession</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/tips" title="tips">tips</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/travis-ci" title="travis-ci">travis-ci</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/videos" title="videos">videos</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/virtualbox" title="virtualbox">virtualbox</a>
        </div>
    </div>
</aside>
            </section>
        </div>
        <div id="footer" class="footer-wrap">
            <footer id="colophon" class="site-footer container clearfix" role="contentinfo">
    <div id="footer-text" class="site-info">
        <span class="credit-link">
            <a href="/" target="_blank">SivaLabs</a>
            Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a>
        </span>
    </div>
</footer>

        </div>
    </div>

</body>
</html>
