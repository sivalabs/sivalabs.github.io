<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    
    
    <div class="analytics">
        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-71296890-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </div>
    
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" property="title" content="SivaLabs - JCart: Configuring Spring Security">
    <meta name="description" property="description" content="Java, Spring, SpringBoot, SpringCloud, JPA, Hibernate, DevOps, MicroServices, Docker tutorials - " >
    <title>SivaLabs - JCart: Configuring Spring Security </title>
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="JCart: Configuring Spring Security"/>
<meta name="twitter:description" content="Our JCart Administration site should only be accessible to authorized users only. So, we are going to use SpringSecurity to define the security constraints.
Let us add the following spring-security dependencies to jcart-admin/pom.xml.
&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf-extras-springsecurity4&lt;/artifactId&gt; &lt;/dependency&gt; If we have predefined set of Roles then we can specify the URL patterns and its required Roles something like this:
http .authorizeRequests() .antMatchers(&#34;/login&#34;,&#34;/login/form**&#34;,&#34;/register&#34;,&#34;/logout&#34;).permitAll() .antMatchers(&#34;/admin&#34;,&#34;/admin/**&#34;).hasRole(&#34;ADMIN&#34;) .anyRequest().authenticated() .and() But we need provision to dynamically create new roles as well, hence we can&rsquo;t statically define constraints using role names."/>
<meta name="twitter:site" content="@sivalabs"/>

    <meta name="twitter:creator" content="@sivalabs"/>
    <meta property="og:title" content="JCart: Configuring Spring Security" />
<meta property="og:description" content="Our JCart Administration site should only be accessible to authorized users only. So, we are going to use SpringSecurity to define the security constraints.
Let us add the following spring-security dependencies to jcart-admin/pom.xml.
&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf-extras-springsecurity4&lt;/artifactId&gt; &lt;/dependency&gt; If we have predefined set of Roles then we can specify the URL patterns and its required Roles something like this:
http .authorizeRequests() .antMatchers(&#34;/login&#34;,&#34;/login/form**&#34;,&#34;/register&#34;,&#34;/logout&#34;).permitAll() .antMatchers(&#34;/admin&#34;,&#34;/admin/**&#34;).hasRole(&#34;ADMIN&#34;) .anyRequest().authenticated() .and() But we need provision to dynamically create new roles as well, hence we can&rsquo;t statically define constraints using role names." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sivalabs.github.io/2015/12/jcart-configuring-spring-security/" />
<meta property="article:published_time" content="2015-12-01T05:27:15+00:00" />
<meta property="article:modified_time" content="2015-12-01T05:27:15+00:00" />

    <meta itemprop="name" content="JCart: Configuring Spring Security">
<meta itemprop="description" content="Our JCart Administration site should only be accessible to authorized users only. So, we are going to use SpringSecurity to define the security constraints.
Let us add the following spring-security dependencies to jcart-admin/pom.xml.
&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf-extras-springsecurity4&lt;/artifactId&gt; &lt;/dependency&gt; If we have predefined set of Roles then we can specify the URL patterns and its required Roles something like this:
http .authorizeRequests() .antMatchers(&#34;/login&#34;,&#34;/login/form**&#34;,&#34;/register&#34;,&#34;/logout&#34;).permitAll() .antMatchers(&#34;/admin&#34;,&#34;/admin/**&#34;).hasRole(&#34;ADMIN&#34;) .anyRequest().authenticated() .and() But we need provision to dynamically create new roles as well, hence we can&rsquo;t statically define constraints using role names.">
<meta itemprop="datePublished" content="2015-12-01T05:27:15&#43;00:00" />
<meta itemprop="dateModified" content="2015-12-01T05:27:15&#43;00:00" />
<meta itemprop="wordCount" content="929">



<meta itemprop="keywords" content="jcart,SpringBoot," />

    <link rel='stylesheet' href="/assets/css/custom-fonts.css" type='text/css' media='all'/>

    <link rel='stylesheet' href="/assets/css/style.css" type='text/css' media='all'/>
    <link rel='stylesheet' href="/assets/css/genericons.css" type='text/css' media='all'/>
    <link rel='stylesheet' href="/assets/css/font-awesome.min.css" type='text/css' media='all'/>
    <link rel='stylesheet' href="/assets/css/socicon.css" type='text/css' media='all'/>
    <link rel="stylesheet" href="/assets/css/social-logos/social-logos.css" type="text/css" media="all">
    <link rel='stylesheet' href="/assets/css/jetpack.css" type='text/css' media='all'/>
    <link rel='stylesheet' href="/assets/css/custom-styles.css" type='text/css' media='all'/>

    <script type='text/javascript' src="/assets/js/jquery-1.12.4.min.js"></script>
    <script type='text/javascript' src="/assets/js/html5shiv.min.js"></script>
    <script type='text/javascript' src="/assets/js/navigation.js"></script>

    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon" />

    

</head>
<body class="home blog logged-in admin-bar no-customize-support post-layout-one-column">
    <div id="header-top" class="header-bar-wrap"></div>
    <div id="page" class="hfeed site">
        <a class="skip-link screen-reader-text" href="#content">Skip to content</a>
        <header id="masthead" class="site-header clearfix" role="banner">
    <div class="header-main container clearfix">
        <div id="logo" class="site-branding clearfix">
            <h1 class="site-title">
                <a href="/" title="SivaLabs" rel="home">SivaLabs</a>
            </h1>
            <p class="site-description">My Experiments on Technology</p>
        </div>
        <div class="header-widgets clearfix">
        </div>
    </div>
    <div id="main-navigation-wrap" class="primary-navigation-wrap">
        <nav id="main-navigation" class="primary-navigation navigation container clearfix" role="navigation">
            <ul id="menu-home" class="main-navigation-menu">
                <li id="menu-item-1145" class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home menu-item-1145">
                    <a href="/">Home</a>
                </li>
                <li id="menu-item-1421" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1421">
                    <a href="/categories/java">Java</a>
                </li>
                <li id="menu-item-1423" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1423">
                    <a href="/categories/spring">Spring</a>
                    <ul class="sub-menu">
                        <li id="menu-item-1424" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1424">
                            <a href="/categories/springboot">Spring Boot</a>
                        </li>
                        <li id="menu-item-1425" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1425">
                            <a href="/categories/springcloud">Spring Cloud</a>
                        </li>
                    </ul>
                </li>
                <li id="menu-item-1422" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1422">
                    <a href="/categories/microservices">MicroServices</a>
                </li>
                <li id="menu-item-1151" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1151">
                    <a href="/videos">Videos</a>
                </li>
                <li id="menu-item-1161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1161">
                    <a href="/mybooks">My Books</a>
                </li>
                <li id="menu-item-1171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1171">
                    <a href="/projects">My Projects</a>
                </li>
                <li id="menu-item-1146" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1146">
                    <a href="/contact">Contact</a>
                </li>
            </ul>
        </nav>
    </div>
</header>
        <div id="content" class="site-content container clearfix">
            <section id="primary" class="content-archive content-area">
                
<main id="main" class="site-main" role="main">
<article class="post type-post status-publish format-standard hentry">
    <div class="post-inner-content">
        <header class="entry-header">
    <div class="entry-meta">
        <span class="meta-date">
            <a href="https://sivalabs.github.io/2015/12/jcart-configuring-spring-security/" rel="bookmark">
                <time class="entry-date published" datetime="2015-12-01T05:27:15">
                December 01, 2015
                </time>
            </a>
        </span>
        <span class="meta-author">
            <span class="author vcard">Siva</span>
        </span>
    </div>
    <h2 class="entry-title">
        <a href="https://sivalabs.github.io/2015/12/jcart-configuring-spring-security/" rel="bookmark">
            JCart: Configuring Spring Security
        </a>
    </h2>
    <div>
        
        
        
        <span class="tagcloud post-tags">
            <i class="fa fa-tags"></i>
            
            <a class="tag-cloud-link widget__link widget__link--taglist" href="/tags/jcart/">jcart</a>
            &nbsp;
            
            <a class="tag-cloud-link widget__link widget__link--taglist" href="/tags/springboot/">SpringBoot</a>
            
            
        </span>
        
        
    </div>
</header>

        <div class="entry-content">
            <p>Our JCart Administration site should only be accessible to authorized users only. So, we are going to use SpringSecurity to define the security constraints.</p>
<p>Let us add the following spring-security dependencies to <strong>jcart-admin/pom.xml</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;dependency&gt;</span>
	<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
	<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-security<span style="color:#f92672">&lt;/artifactId&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
<span style="color:#f92672">&lt;dependency&gt;</span>
	<span style="color:#f92672">&lt;groupId&gt;</span>org.thymeleaf.extras<span style="color:#f92672">&lt;/groupId&gt;</span>
	<span style="color:#f92672">&lt;artifactId&gt;</span>thymeleaf-extras-springsecurity4<span style="color:#f92672">&lt;/artifactId&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
</code></pre></div><p>If we have predefined set of Roles then we can specify the URL patterns and its required Roles something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">http
	<span style="color:#f92672">.</span><span style="color:#a6e22e">authorizeRequests</span><span style="color:#f92672">()</span>
	    <span style="color:#f92672">.</span><span style="color:#a6e22e">antMatchers</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/login&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;/login/form**&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;/register&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;/logout&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">permitAll</span><span style="color:#f92672">()</span>
	    <span style="color:#f92672">.</span><span style="color:#a6e22e">antMatchers</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/admin&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;/admin/**&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">hasRole</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ADMIN&#34;</span><span style="color:#f92672">)</span>
	    <span style="color:#f92672">.</span><span style="color:#a6e22e">anyRequest</span><span style="color:#f92672">().</span><span style="color:#a6e22e">authenticated</span><span style="color:#f92672">()</span>
	    <span style="color:#f92672">.</span><span style="color:#a6e22e">and</span><span style="color:#f92672">()</span>
</code></pre></div><p>But we need provision to dynamically create new roles as well, hence we can&rsquo;t statically define constraints using role names.</p>
<p>But in our JCart application, we have fixed list of permissions and then grouped them as Roles. So we can configure SpringSecurity to use Method Level Security by checking the permissions.</p>
<p>SpringSecurity don&rsquo;t have the support for Permissions. So we will follow suggestion given here <!-- raw HTML omitted --><a href="http://springinpractice.com/2010/10/27/quick-tip-spring-security-role-based-authorization-and-permissions">http://springinpractice.com/2010/10/27/quick-tip-spring-security-role-based-authorization-and-permissions</a><!-- raw HTML omitted --> where we consider the Permissions as Roles.</p>
<h3 id="userrepository-to-get-user-by-email">UserRepository to get User by Email</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserRepository</span> <span style="color:#66d9ef">extends</span> JpaRepository<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">,</span> Integer<span style="color:#f92672">&gt;</span>
<span style="color:#f92672">{</span>
	User <span style="color:#a6e22e">findByEmail</span><span style="color:#f92672">(</span>String email<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="securityservice-8211-facade-to-all-security-related-methods">SecurityService – Facade to all Security Related Methods</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Service</span>
<span style="color:#a6e22e">@Transactional</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SecurityService</span>
<span style="color:#f92672">{</span>
	<span style="color:#a6e22e">@Autowired</span> UserRepository userRepository<span style="color:#f92672">;</span>
	
	<span style="color:#66d9ef">public</span> User <span style="color:#a6e22e">findUserByEmail</span><span style="color:#f92672">(</span>String email<span style="color:#f92672">)</span>
	<span style="color:#f92672">{</span>
	     <span style="color:#66d9ef">return</span> userRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">findByEmail</span><span style="color:#f92672">(</span>email<span style="color:#f92672">);</span>
	<span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="wrapper-for-springsecurity-user">Wrapper for SpringSecurity User</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AuthenticatedUser</span> <span style="color:#66d9ef">extends</span> org<span style="color:#f92672">.</span><span style="color:#a6e22e">springframework</span><span style="color:#f92672">.</span><span style="color:#a6e22e">security</span><span style="color:#f92672">.</span><span style="color:#a6e22e">core</span><span style="color:#f92672">.</span><span style="color:#a6e22e">userdetails</span><span style="color:#f92672">.</span><span style="color:#a6e22e">User</span>
<span style="color:#f92672">{</span>

	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">long</span> serialVersionUID <span style="color:#f92672">=</span> 1L<span style="color:#f92672">;</span>
	<span style="color:#66d9ef">private</span> User user<span style="color:#f92672">;</span>
	
	<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">AuthenticatedUser</span><span style="color:#f92672">(</span>User user<span style="color:#f92672">)</span>
	<span style="color:#f92672">{</span>
	    <span style="color:#66d9ef">super</span><span style="color:#f92672">(</span>user<span style="color:#f92672">.</span><span style="color:#a6e22e">getEmail</span><span style="color:#f92672">(),</span> user<span style="color:#f92672">.</span><span style="color:#a6e22e">getPassword</span><span style="color:#f92672">(),</span> getAuthorities<span style="color:#f92672">(</span>user<span style="color:#f92672">));</span>
	    <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> user<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
	
	<span style="color:#66d9ef">public</span> User <span style="color:#a6e22e">getUser</span><span style="color:#f92672">()</span>
	<span style="color:#f92672">{</span>
	    <span style="color:#66d9ef">return</span> user<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
	
	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> Collection<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">extends</span> GrantedAuthority<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getAuthorities</span><span style="color:#f92672">(</span>User user<span style="color:#f92672">)</span>
	<span style="color:#f92672">{</span>
	Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> roleAndPermissions <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashSet<span style="color:#f92672">&lt;&gt;();</span>
	List<span style="color:#f92672">&lt;</span>Role<span style="color:#f92672">&gt;</span> roles <span style="color:#f92672">=</span> user<span style="color:#f92672">.</span><span style="color:#a6e22e">getRoles</span><span style="color:#f92672">();</span>
	
	<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Role role <span style="color:#f92672">:</span> roles<span style="color:#f92672">)</span>
	<span style="color:#f92672">{</span>
	roleAndPermissions<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>role<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">());</span>
	List<span style="color:#f92672">&lt;</span>Permission<span style="color:#f92672">&gt;</span> permissions <span style="color:#f92672">=</span> role<span style="color:#f92672">.</span><span style="color:#a6e22e">getPermissions</span><span style="color:#f92672">();</span>
	<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Permission permission <span style="color:#f92672">:</span> permissions<span style="color:#f92672">)</span>
	<span style="color:#f92672">{</span>
	roleAndPermissions<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ROLE_&#34;</span><span style="color:#f92672">+</span>permission<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">());</span>
	<span style="color:#f92672">}</span>
	<span style="color:#f92672">}</span>
	String<span style="color:#f92672">[]</span> roleNames <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String<span style="color:#f92672">[</span>roleAndPermissions<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">()];</span>
	Collection<span style="color:#f92672">&lt;</span>GrantedAuthority<span style="color:#f92672">&gt;</span> authorities <span style="color:#f92672">=</span> AuthorityUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">createAuthorityList</span><span style="color:#f92672">(</span>roleAndPermissions<span style="color:#f92672">.</span><span style="color:#a6e22e">toArray</span><span style="color:#f92672">(</span>roleNames<span style="color:#f92672">));</span>
	<span style="color:#66d9ef">return</span> authorities<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="custom-userdetailsservice-implementation">Custom UserDetailsService Implementation</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Service</span>
<span style="color:#a6e22e">@Transactional</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CustomUserDetailsService</span> <span style="color:#66d9ef">implements</span> UserDetailsService
<span style="color:#f92672">{</span>
	<span style="color:#a6e22e">@Autowired</span>
	<span style="color:#66d9ef">private</span> SecurityService securityService<span style="color:#f92672">;</span>
	
	<span style="color:#a6e22e">@Override</span>
	<span style="color:#66d9ef">public</span> UserDetails <span style="color:#a6e22e">loadUserByUsername</span><span style="color:#f92672">(</span>String userName<span style="color:#f92672">)</span>
	<span style="color:#66d9ef">throws</span> UsernameNotFoundException <span style="color:#f92672">{</span>
	User user <span style="color:#f92672">=</span> securityService<span style="color:#f92672">.</span><span style="color:#a6e22e">findUserByEmail</span><span style="color:#f92672">(</span>userName<span style="color:#f92672">);</span>
	<span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>user <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">){</span>
	<span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UsernameNotFoundException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Email &#34;</span><span style="color:#f92672">+</span>userName<span style="color:#f92672">+</span><span style="color:#e6db74">&#34; not found&#34;</span><span style="color:#f92672">);</span>
	<span style="color:#f92672">}</span>
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> AuthenticatedUser<span style="color:#f92672">(</span>user<span style="color:#f92672">);</span>
	<span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><h3 id="springsecurity-configuration">SpringSecurity Configuration</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#a6e22e">@EnableWebSecurity</span>
<span style="color:#a6e22e">@EnableGlobalMethodSecurity</span><span style="color:#f92672">(</span>securedEnabled <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">,</span> proxyTargetClass <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WebSecurityConfig</span> <span style="color:#66d9ef">extends</span> WebSecurityConfigurerAdapter <span style="color:#f92672">{</span>
	
	<span style="color:#a6e22e">@Autowired</span>
	<span style="color:#66d9ef">private</span> UserDetailsService customUserDetailsService<span style="color:#f92672">;</span>
	
	<span style="color:#a6e22e">@Bean</span>
    <span style="color:#66d9ef">public</span> PasswordEncoder <span style="color:#a6e22e">passwordEncoder</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> BCryptPasswordEncoder<span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
	
	<span style="color:#a6e22e">@Autowired</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">configureGlobal</span><span style="color:#f92672">(</span>AuthenticationManagerBuilder auth<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
        auth
        	<span style="color:#f92672">.</span><span style="color:#a6e22e">userDetailsService</span><span style="color:#f92672">(</span>customUserDetailsService<span style="color:#f92672">)</span>
        	<span style="color:#f92672">.</span><span style="color:#a6e22e">passwordEncoder</span><span style="color:#f92672">(</span>passwordEncoder<span style="color:#f92672">());</span>
    <span style="color:#f92672">}</span>
	
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">configure</span><span style="color:#f92672">(</span>HttpSecurity http<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
        http
        	<span style="color:#f92672">.</span><span style="color:#a6e22e">csrf</span><span style="color:#f92672">().</span><span style="color:#a6e22e">disable</span><span style="color:#f92672">()</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">authorizeRequests</span><span style="color:#f92672">()</span>
            	<span style="color:#f92672">.</span><span style="color:#a6e22e">antMatchers</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/resources/**&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;/webjars/**&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;/assets/**&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">permitAll</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">antMatchers</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;/forgotPwd&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;/resetPwd&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">permitAll</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">anyRequest</span><span style="color:#f92672">().</span><span style="color:#a6e22e">authenticated</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">and</span><span style="color:#f92672">()</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">formLogin</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">loginPage</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/login&#34;</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">defaultSuccessUrl</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/home&#34;</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">failureUrl</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/login?error&#34;</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">permitAll</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">and</span><span style="color:#f92672">()</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">logout</span><span style="color:#f92672">()</span>
            	<span style="color:#f92672">.</span><span style="color:#a6e22e">logoutRequestMatcher</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> AntPathRequestMatcher<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/logout&#34;</span><span style="color:#f92672">))</span>
            	<span style="color:#f92672">.</span><span style="color:#a6e22e">permitAll</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">and</span><span style="color:#f92672">()</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">exceptionHandling</span><span style="color:#f92672">().</span><span style="color:#a6e22e">accessDeniedPage</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/403&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>    
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="access-denied-exception-handler">Access Denied Exception Handler</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Controller</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ErrorController</span>
<span style="color:#f92672">{</span>	
	<span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/403&#34;</span><span style="color:#f92672">)</span>
	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">accessDenied</span><span style="color:#f92672">()</span>
	<span style="color:#f92672">{</span>
	<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;error/accessDenied&#34;</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
	
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="abstract-controller-with-common-methods">Abstract Controller with Common Methods</h3>
<p>Let us create a base Abstract Controller to have the common methods by all controllers.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">JCartAdminBaseController</span>
<span style="color:#f92672">{</span>	
	<span style="color:#a6e22e">@Autowired</span> <span style="color:#66d9ef">protected</span> MessageSource messageSource<span style="color:#f92672">;</span>
	
	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span>String code<span style="color:#f92672">)</span>
	<span style="color:#f92672">{</span>
		<span style="color:#66d9ef">return</span> messageSource<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span>code<span style="color:#f92672">,</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">);</span>
	<span style="color:#f92672">}</span>
	
	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span>String code<span style="color:#f92672">,</span> String defaultMsg<span style="color:#f92672">)</span>
	<span style="color:#f92672">{</span>
		<span style="color:#66d9ef">return</span> messageSource<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span>code<span style="color:#f92672">,</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">,</span> defaultMsg<span style="color:#f92672">,</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">);</span>
	<span style="color:#f92672">}</span>
	
	<span style="color:#a6e22e">@ModelAttribute</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;authenticatedUser&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">public</span> AuthenticatedUser <span style="color:#a6e22e">authenticatedUser</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@AuthenticationPrincipal</span> AuthenticatedUser authenticatedUser<span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> authenticatedUser<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
	
	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> AuthenticatedUser <span style="color:#a6e22e">getCurrentUser</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>

	    Object principal <span style="color:#f92672">=</span> SecurityContextHolder<span style="color:#f92672">.</span><span style="color:#a6e22e">getContext</span><span style="color:#f92672">().</span><span style="color:#a6e22e">getAuthentication</span><span style="color:#f92672">().</span><span style="color:#a6e22e">getPrincipal</span><span style="color:#f92672">();</span>
	    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>principal <span style="color:#66d9ef">instanceof</span> AuthenticatedUser<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	    	<span style="color:#66d9ef">return</span> <span style="color:#f92672">((</span>AuthenticatedUser<span style="color:#f92672">)</span> principal<span style="color:#f92672">);</span>
	    <span style="color:#f92672">}</span>
	    <span style="color:#75715e">// principal object is either null or represents anonymous user -
</span><span style="color:#75715e"></span>	    <span style="color:#75715e">// neither of which our domain User object can represent - so return null
</span><span style="color:#75715e"></span>	    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>

	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">isLoggedIn</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
	    <span style="color:#66d9ef">return</span> getCurrentUser<span style="color:#f92672">()</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>Observe how we injected Authenticated User object using <strong>@AuthenticationPrincipal</strong> and exposed as a ModelAttribute so that we can reference it in any of our templates. Also we have another method which return the AuthenticatedUser so that we can use it in any of our Controllers to access currently logged in user object, say to set CreatedBy/UpdatedBy objects on our JPA Entities.</p>
<p>Now our Controllers can extend the JCartAdminBaseController class as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Controller</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HomeController</span> <span style="color:#66d9ef">extends</span> JCartAdminBaseController
<span style="color:#f92672">{</span>
	<span style="color:#f92672">...</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="registering-springsecuritydialect-with-thymeleaf">Registering SpringSecurityDialect with Thymeleaf</h3>
<p>In order to use SpringSecurity dialects features in Thymeleaf templates we need to register SpringSecurityDialect as an additional dialect. We can do this simply by registering a SpringSecurityDialect bean.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WebConfig</span> <span style="color:#66d9ef">extends</span> WebMvcConfigurerAdapter
<span style="color:#f92672">{</span>   
	<span style="color:#f92672">...</span>
	
	<span style="color:#a6e22e">@Bean</span>
	<span style="color:#66d9ef">public</span> SpringSecurityDialect <span style="color:#a6e22e">securityDialect</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
	    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> SpringSecurityDialect<span style="color:#f92672">();</span>
	<span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>For more info read <!-- raw HTML omitted --><a href="http://www.thymeleaf.org/doc/articles/springsecurity.html">http://www.thymeleaf.org/doc/articles/springsecurity.html</a><!-- raw HTML omitted --></p>
<h3 id="using-springsecurity-in-thymeleaf-templates">Using SpringSecurity in Thymeleaf Templates</h3>
<p>Now we can show the Left Nav Menu options by checking whether the logged in user has the Permission or not.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">xmlns</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.w3.org/1999/xhtml&#34;</span> 
	  <span style="color:#a6e22e">xmlns:th</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.thymeleaf.org&#34;</span>
	  <span style="color:#a6e22e">xmlns:sec</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.thymeleaf.org/thymeleaf-extras-springsecurity3&#34;</span>&gt;

&lt;<span style="color:#f92672">body</span>&gt;
	&lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">sec:authentication</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;principal.user.name&#34;</span>&gt;User&lt;/<span style="color:#f92672">span</span>&gt;
	

&lt;<span style="color:#f92672">p</span>&gt;
  Welcome &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">th:text</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;${authenticatedUser.user.name}&#34;</span>&gt;User&lt;/<span style="color:#f92672">span</span>&gt;!
&lt;/<span style="color:#f92672">p</span>&gt;
	
	

&lt;<span style="color:#f92672">li</span> <span style="color:#a6e22e">sec:authorize</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;hasRole(&#39;ROLE_MANAGE_CATEGORIES&#39;)&#34;</span>&gt;
  &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#&#34;</span> <span style="color:#a6e22e">th:href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;@{&#39;/categories&#39;}&#34;</span>&gt;&lt;<span style="color:#f92672">i</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;fa fa-folder-open&#34;</span>&gt;&lt;/<span style="color:#f92672">i</span>&gt; &lt;<span style="color:#f92672">span</span>&gt;Categories&lt;/<span style="color:#f92672">span</span>&gt;&lt;/<span style="color:#f92672">a</span>&gt;
  	
&lt;/<span style="color:#f92672">li</span>&gt;
    

&lt;<span style="color:#f92672">li</span> <span style="color:#a6e22e">sec:authorize</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;hasRole(&#39;ROLE_MANAGE_PRODUCTS&#39;)&#34;</span>&gt;
  &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#&#34;</span> <span style="color:#a6e22e">th:href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;@{&#39;/products&#39;}&#34;</span>&gt;&lt;<span style="color:#f92672">i</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;fa fa-file&#34;</span>&gt;&lt;/<span style="color:#f92672">i</span>&gt; &lt;<span style="color:#f92672">span</span>&gt;Products&lt;/<span style="color:#f92672">span</span>&gt;&lt;/<span style="color:#f92672">a</span>&gt;
  	
&lt;/<span style="color:#f92672">li</span>&gt;
	
   &lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><p>In our Controllers we can check for Permissions as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Controller</span>
<span style="color:#a6e22e">@Secured</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ROLE_MANAGE_CATEGORIES&#34;</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CategoryController</span> <span style="color:#66d9ef">extends</span> JCartAdminBaseController
<span style="color:#f92672">{</span>
	<span style="color:#f92672">...</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="registering-a-filter-after-springsecurity-filter">Registering a Filter After SpringSecurity Filter</h3>
<p>I would like to show the currently selected Left Nav Menu link as Active. For that I thought of keep tracking the clicked URL and store the ACTIVE_MENU value in model and then conditionally apply Active style in Thymeleaf template.</p>
<p>For this I thought of registering a Filter filter after SpringSecurityFilter. But SpringSecurity Filter is registered with LOWEST_PRIORITY order automatically. So we need to get it done using the hack explained here <!-- raw HTML omitted --><a href="http://stackoverflow.com/questions/25957879/filter-order-in-spring-boot">http://stackoverflow.com/questions/25957879/filter-order-in-spring-boot</a><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WebConfig</span> <span style="color:#66d9ef">extends</span> WebMvcConfigurerAdapter
<span style="color:#f92672">{</span>  
	<span style="color:#f92672">...</span>
	<span style="color:#f92672">...</span>
	
	<span style="color:#a6e22e">@Autowired</span> 
	<span style="color:#66d9ef">private</span> PostAuthorizationFilter postAuthorizationFilter<span style="color:#f92672">;</span>
	    	
	<span style="color:#a6e22e">@Bean</span>
	<span style="color:#66d9ef">public</span> FilterRegistrationBean <span style="color:#a6e22e">securityFilterChain</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Qualifier</span><span style="color:#f92672">(</span>AbstractSecurityWebApplicationInitializer<span style="color:#f92672">.</span><span style="color:#a6e22e">DEFAULT_FILTER_NAME</span><span style="color:#f92672">)</span> Filter securityFilter<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	    FilterRegistrationBean registration <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FilterRegistrationBean<span style="color:#f92672">(</span>securityFilter<span style="color:#f92672">);</span>
	    registration<span style="color:#f92672">.</span><span style="color:#a6e22e">setOrder</span><span style="color:#f92672">(</span>Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">MAX_VALUE</span> <span style="color:#f92672">-</span> 1<span style="color:#f92672">);</span>
	    registration<span style="color:#f92672">.</span><span style="color:#a6e22e">setName</span><span style="color:#f92672">(</span>AbstractSecurityWebApplicationInitializer<span style="color:#f92672">.</span><span style="color:#a6e22e">DEFAULT_FILTER_NAME</span><span style="color:#f92672">);</span>
	    <span style="color:#66d9ef">return</span> registration<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>

	<span style="color:#a6e22e">@Bean</span>
	<span style="color:#66d9ef">public</span> FilterRegistrationBean <span style="color:#a6e22e">PostAuthorizationFilterRegistrationBean</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
	    FilterRegistrationBean registrationBean <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FilterRegistrationBean<span style="color:#f92672">();</span>
	    registrationBean<span style="color:#f92672">.</span><span style="color:#a6e22e">setFilter</span><span style="color:#f92672">(</span>postAuthorizationFilter<span style="color:#f92672">);</span>
	    registrationBean<span style="color:#f92672">.</span><span style="color:#a6e22e">setOrder</span><span style="color:#f92672">(</span>Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">MAX_VALUE</span><span style="color:#f92672">);</span>
	    <span style="color:#66d9ef">return</span> registrationBean<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Component</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostAuthorizationFilter</span> <span style="color:#66d9ef">extends</span> OncePerRequestFilter
<span style="color:#f92672">{</span>	
	<span style="color:#a6e22e">@Override</span>
	<span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">doFilterInternal</span><span style="color:#f92672">(</span>HttpServletRequest request<span style="color:#f92672">,</span> HttpServletResponse response<span style="color:#f92672">,</span> FilterChain chain<span style="color:#f92672">)</span>
	<span style="color:#66d9ef">throws</span> ServletException<span style="color:#f92672">,</span> IOException
	<span style="color:#f92672">{</span>
	String uri <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span><span style="color:#a6e22e">getRequestURI</span><span style="color:#f92672">();</span>	
	String menu <span style="color:#f92672">=</span> <span style="color:#f92672">...;</span>
	request<span style="color:#f92672">.</span><span style="color:#a6e22e">setAttribute</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;CURRENT_MENU&#34;</span><span style="color:#f92672">,</span> menu<span style="color:#f92672">);</span>
	
	chain<span style="color:#f92672">.</span><span style="color:#a6e22e">doFilter</span><span style="color:#f92672">(</span>request<span style="color:#f92672">,</span> response<span style="color:#f92672">);</span>
	<span style="color:#f92672">}</span>
	
<span style="color:#f92672">}</span>
</code></pre></div><p>For complete PostAuthorizationFilter code, please check in github repository <!-- raw HTML omitted --><a href="https://github.com/sivaprasadreddy/jcart">https://github.com/sivaprasadreddy/jcart</a><!-- raw HTML omitted -->.</p>
<p>Now we have Spring Security configured for our application. In our next posts we will see how to protect Controller methods at class/method level.</p>

        </div>
        <div class="sharedaddy sd-sharing-enabled">
    <div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing">
        <h3 class="sd-title">Share this:</h3>
        <div class="sd-content">
            <ul>
                <li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-1144" class="share-twitter sd-button share-icon no-text" href="https://twitter.com/intent/tweet?status=JCart%3a%20Configuring%20Spring%20Security-https%3a%2f%2fsivalabs.github.io%2f2015%2f12%2fjcart-configuring-spring-security%2f" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li>
                <li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-1144" class="share-facebook sd-button share-icon no-text" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fsivalabs.github.io%2f2015%2f12%2fjcart-configuring-spring-security%2f" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li>
                <li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-1144" class="share-google-plus-1 sd-button share-icon no-text" href="https://plus.google.com/share?url=https%3a%2f%2fsivalabs.github.io%2f2015%2f12%2fjcart-configuring-spring-security%2f" target="_blank" title="Click to share on Google+"><span></span><span class="sharing-screen-reader-text">Click to share on Google+ (Opens in new window)</span></a></li>
                <li class="share-reddit"><a rel="nofollow" data-shared="" class="share-reddit sd-button share-icon no-text" href="http://www.reddit.com/submit?url=https%3a%2f%2fsivalabs.github.io%2f2015%2f12%2fjcart-configuring-spring-security%2f&title=JCart%3a%20Configuring%20Spring%20Security" target="_blank" title="Click to share on Reddit"><span></span><span class="sharing-screen-reader-text">Click to share on Reddit (Opens in new window)</span></a></li>
                <li class="share-linkedin"><a rel="nofollow" data-shared="sharing-linkedin-1144" class="share-linkedin sd-button share-icon no-text" href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fsivalabs.github.io%2f2015%2f12%2fjcart-configuring-spring-security%2f&title=JCart%3a%20Configuring%20Spring%20Security" target="_blank" title="Click to share on LinkedIn"><span></span><span class="sharing-screen-reader-text">Click to share on LinkedIn (Opens in new window)</span></a></li>
                <li class="share-end"></li>
            </ul>
        </div>
    </div>
</div>

    </div>
</article>


<div class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "sivalabs" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>



<nav class="navigation post-navigation" role="navigation">
	<h2 class="screen-reader-text">Post navigation</h2>
	<div class="nav-links">
		<div class="nav-previous">
			<a href="/2015/12/jcart-email-service-setup/" rel="next">
				<i class="fa fa-chevron-left"></i>
				<span class="post-title">JCart: Email Service SetUp</span>
			</a>
		</div>
		<div class="nav-next">
			<a href="/2015/12/jcart-admin-ui-layout-setup/" rel="prev">
                <span class="post-title">JCart: Admin UI Layout SetUp
                    <i class="fa fa-chevron-right"></i>
                </span>
			</a>
		</div>
	</div>
</nav>

</main>

            </section>

            <section id="secondary" class="sidebar widget-area clearfix" role="complementary">
                
<aside id="zoom-social-icons-widget-2" class="widget zoom-social-icons-widget">
    <h3 class="widget-title">Follow Me</h3>

    <ul class="zoom-social-icons-list zoom-social-icons-list--with-canvas zoom-social-icons-list--rounded zoom-social-icons-list--no-labels">

        
        <li class="zoom-social_icons-list__item">
            <a class="zoom-social_icons-list__link"
               href="https://github.com/sivaprasadreddy"
               target="_blank">
                    <span class="zoom-social_icons-list-span socicon socicon-github"
                          data-hover-rule="background-color" data-hover-color="#221e1b"

                    ></span>
            </a>
        </li>
        

        
        <li class="zoom-social_icons-list__item">
            <a class="zoom-social_icons-list__link"
               href="https://twitter.com/sivalabs"
               target="_blank">
                    <span class="zoom-social_icons-list-span socicon socicon-twitter"
                          data-hover-rule="background-color" data-hover-color="#55acee"
                    ></span>
            </a>
        </li>
        

        

        

        
        <li class="zoom-social_icons-list__item">
            <a class="zoom-social_icons-list__link"
               href="https://in.linkedin.com/in/siva-prasad-reddy-k-3a909172"
               target="_blank">
                    <span class="zoom-social_icons-list-span socicon socicon-linkedin"
                          data-hover-rule="background-color" data-hover-color="#3371b7"
                    ></span>
            </a>
        </li>

        

        
        <li class="zoom-social_icons-list__item">
            <a class="zoom-social_icons-list__link"
               href="http://www.youtube.com/c/SivaPrasadReddy%20"
               target="_blank">
                    <span class="zoom-social_icons-list-span socicon socicon-youtube"
                          data-hover-rule="background-color" data-hover-color="#e02a20"
                    ></span>
            </a>
        </li>
        
    </ul>
</aside>



<aside id="recent-posts-2" class="widget widget_recent_entries clearfix">
    <div class="widget-header">
        <h3 class="widget-title">Recent Posts</h3>
    </div>
    <ul>
        <li class="widget__item"><a class="widget__link" href="/2020/07/golang-from-a-java-developer-perspective/">GoLang from a Java developer perspective</a></li>
        <li class="widget__item"><a class="widget__link" href="/2020/06/my-proud-moment-as-a-mentor/">My proud moment as a mentor</a></li>
        <li class="widget__item"><a class="widget__link" href="/2020/05/remote-debugging-spring-boot-application/">Remote debugging springboot application</a></li>
        <li class="widget__item"><a class="widget__link" href="/2020/04/what-i-learned-2020-week-14/">What I Learned in Week-14, 2020</a></li>
        <li class="widget__item"><a class="widget__link" href="/2020/04/impose-architecture-guidelines-using-archunit/">Imposing Code Structure Guidelines using ArchUnit</a></li>
    </ul>

</aside>

<aside id="top-posts-2" class="widget widget_top-posts clearfix">
    <div class="widget-header"><h3 class="widget-title">Top Posts &amp; Pages</h3></div>
    <ul>

        <li>
            <a href="/2016/03/why-springboot/"
            class="bump-view" data-bump-view="tp">
            Why SpringBoot?</a>
        </li>

        <li>
            <a href="/2016/03/how-springboot-autoconfiguration-magic/"
            class="bump-view" data-bump-view="tp">
            How SpringBoot AutoConfiguration magic works?</a>
        </li>

        <li>
            <a href="/2015/11/developing-a-simple-e-commerce-application-from-scratch-to-production-using-springboot/"
            class="bump-view" data-bump-view="tp">
            Developing a simple e-commerce application from scratch to production using SpringBoot</a>
        </li>

        <li>
            <a href="/2013/12/clean-code-dont-mix-different-levels-of-abstractions/"
            class="bump-view" data-bump-view="tp">
            Clean Code: Don’t mix different levels of abstractions</a>
        </li>

        <li>
            <a href="/2015/06/a-developers-perspective-on-spring-vs-javaee/"
            class="bump-view" data-bump-view="tp">
            A Developers Perspective on Spring vs JavaEE</a>
        </li>

        <li>
            <a href="/2015/07/my-life-as-software-developer-in-india/"
            class="bump-view" data-bump-view="tp">
            My Life as a Software Developer in India</a>
        </li>

        <li>
            <a href="/2011/01/10-things-to-become-outstanding-java/"
            class="bump-view" data-bump-view="tp">
            10 things to become an outstanding Java developer</a>
        </li>
</ul>
</aside>

<aside id="categories-2" class="widget widget_categories clearfix">
    <div class="widget-header"><h3 class="widget-title">Categories</h3></div>
    <ul>
        <li class="cat-item"><a href="/categories/best-practices">Best-Practices</a></li>
        <li class="cat-item"><a href="/categories/blog">Blog</a></li>
        <li class="cat-item"><a href="/categories/books">Books</a></li>
        <li class="cat-item"><a href="/categories/career">Career</a></li>
        <li class="cat-item"><a href="/categories/golang">Golang</a></li>
        <li class="cat-item"><a href="/categories/ide">Ide</a></li>
        <li class="cat-item"><a href="/categories/java">Java</a></li>
        <li class="cat-item"><a href="/categories/javaee">Javaee</a></li>
        <li class="cat-item"><a href="/categories/kafka">Kafka</a></li>
        <li class="cat-item"><a href="/categories/linux">Linux</a></li>
        <li class="cat-item"><a href="/categories/microservices">Microservices</a></li>
        <li class="cat-item"><a href="/categories/misc">Misc</a></li>
        <li class="cat-item"><a href="/categories/spring">Spring</a></li>
        <li class="cat-item"><a href="/categories/springboot">Springboot</a></li>
        <li class="cat-item"><a href="/categories/springcloud">Springcloud</a></li>
        <li class="cat-item"><a href="/categories/testing">Testing</a></li>
        <li class="cat-item"><a href="/categories/tips">Tips</a></li>
        <li class="cat-item"><a href="/categories/travis-ci">Travis-Ci</a></li>
        <li class="cat-item"><a href="/categories/videos">Videos</a></li>
    </ul>
</aside>


<aside id="tag_cloud-3" class="widget widget_tag_cloud clearfix">
    <div class="widget-header"><h3 class="widget-title">Tags</h3></div>
    <div class="tagcloud">

        <div class="widget__content">
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/android" title="android">android</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/best-practices" title="best-practices">best-practices</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/blog" title="blog">blog</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/blogging" title="blogging">blogging</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/books" title="books">books</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/career-it" title="career-it">career-it</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/e-commerce" title="e-commerce">e-commerce</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/golang-java" title="golang-java">golang-java</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/ide" title="ide">ide</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/interviews" title="interviews">interviews</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/it" title="it">it</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/java" title="java">java</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/java-bestpractices" title="java-bestpractices">java-bestpractices</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/java-blogging" title="java-blogging">java-blogging</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/java-springboot" title="java-springboot">java-springboot</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/javaee" title="javaee">javaee</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/jcart" title="jcart">jcart</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/jooq" title="jooq">jooq</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/jsf" title="jsf">jsf</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/kafka" title="kafka">kafka</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/kafka-springboot-spring" title="kafka-springboot-spring">kafka-springboot-spring</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/linux" title="linux">linux</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/maven" title="maven">maven</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/microservices" title="microservices">microservices</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/mybatis" title="mybatis">mybatis</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/postman-newman-rest" title="postman-newman-rest">postman-newman-rest</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/primefaces" title="primefaces">primefaces</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/rabbitmq" title="rabbitmq">rabbitmq</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/servlets-jsp" title="servlets-jsp">servlets-jsp</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/spring" title="spring">spring</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/spring-springboot-bestpractices" title="spring-springboot-bestpractices">spring-springboot-bestpractices</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/spring-springboot-testing" title="spring-springboot-testing">spring-springboot-testing</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/springboot" title="springboot">springboot</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/springboot-testcontainers" title="springboot-testcontainers">springboot-testcontainers</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/springboot-yeoman" title="springboot-yeoman">springboot-yeoman</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/springcloud" title="springcloud">springcloud</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/springsession" title="springsession">springsession</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/tips" title="tips">tips</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/travis-ci" title="travis-ci">travis-ci</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/videos" title="videos">videos</a>
            <a class="tag-cloud-link widget__link widget__link--taglist"
               href="/tags/virtualbox" title="virtualbox">virtualbox</a>
        </div>
    </div>
</aside>
            </section>
        </div>
        <div id="footer" class="footer-wrap">
            <footer id="colophon" class="site-footer container clearfix" role="contentinfo">
    <div id="footer-text" class="site-info">
        <span class="credit-link">
            <a href="/" target="_blank">SivaLabs</a>
            Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a>
        </span>
    </div>
</footer>

        </div>
    </div>

</body>
</html>
